# Amazon販売KPI管理ツール

Google Spreadsheet + Google Apps Scriptベースの Amazon販売KPI管理システムです。月利80万円達成を目指すAmazon物販事業者向けに設計されています。

## 🎯 概要

このツールは以下の機能を提供します：

- **Amazon SP-API連携**: 注文・在庫データの自動取得
- **マカドCSV統合**: マカドからの販売履歴取り込み
- **KPI自動計算**: 粗利、ROI、在庫回転率など主要指標の算出
- **リアルタイムダッシュボード**: 月次・日次KPIの可視化
- **アラート機能**: 在庫切れ、滞留在庫、目標未達の自動通知
- **データ統合**: 複数ソースのデータを統一SKUで管理

## 📊 管理するKPI

### 売上・利益KPI
- **月間粗利益**: 目標80万円/月
- **利益率**: 目標25%以上
- **ROI**: 目標30%以上
- **売上高**: 月間270〜320万円

### 在庫管理KPI
- **在庫金額**: 上限100万円
- **在庫回転率**: 月1回転以上
- **滞留在庫率**: 10%未満
- **回転日数**: 30日以内

### 販売効率KPI
- **月間販売数**: 400〜600点
- **取扱ASIN数**: 新商品投入状況
- **平均販売単価**: 商品戦略指標
- **時間あたり粗利**: 2,000円/時以上

## 🚀 セットアップ

### 1. Google Spreadsheetの準備

1. 新しいGoogle Spreadsheetを作成
2. Google Apps Scriptエディタを開く（拡張機能 > Apps Script）
3. 本リポジトリの`src/`フォルダのすべての`.gs`ファイルをApps Scriptプロジェクトにコピー

### 2. 初期セットアップ実行

1. Apps Scriptエディタで`Code.gs`の`initialSetup()`関数を実行
2. 必要な権限を承認
3. 自動的に必要なシートが作成されます

### 3. API認証情報の設定

「設定」シートで以下を設定：

#### Amazon SP-API設定
- **Client ID**: Amazon Developer Consoleで取得
- **Client Secret**: Amazon Developer Consoleで取得  
- **Refresh Token**: SP-API認証フローで取得
- **Marketplace ID**: `A1VC38T7YXB528`（日本）

#### 通知設定（オプション）
- **通知メールアドレス**: エラー・アラート受信用
- **Slack Webhook URL**: Slack通知用（オプション）

### 4. 初回データ取得

1. スプレッドシートメニューから「KPI管理ツール」 > 「データ更新」
2. マカドCSVがある場合：「インポート」 > 「マカドCSV取り込み」

## 📁 ファイル構成

```
src/
├── Code.gs                 # メインファイル・UI制御
├── core/
│   ├── Config.gs          # 設定管理
│   ├── KPICalculator.gs   # KPI計算エンジン
│   ├── SetupManager.gs    # 初期セットアップ
│   └── BatchProcessor.gs  # バッチ処理
├── utils/
│   ├── Utils.gs           # ユーティリティ関数
│   └── ErrorHandler.gs    # エラーハンドリング
├── api/
│   └── MakadoProcessor.gs # マカドCSV処理
└── ui/
    └── (将来の拡張用)

tests/
└── TestRunner.gs          # テスト実行

docs/
├── 基本設計書_KPI管理ツール.md
└── 詳細設計書_KPI管理ツール.md
```

## 🔄 使用方法

### 日常の運用

1. **データ更新**: 「データ更新」ボタンで最新データを取得
2. **KPI確認**: 「KPI月次管理」シートでダッシュボード確認
3. **在庫管理**: 「在庫一覧」シートで在庫状況をチェック
4. **マカドCSV**: 新しいCSVファイルは自動で検出・取り込み

### 自動化

- **日次バッチ**: 毎朝6時に自動データ更新
- **アラート**: 閾値超過時に自動メール/Slack通知
- **レポート**: 週次・月次レポートの自動生成

### メニュー操作

#### 📊 データ更新
- 全データソースから最新情報を取得
- KPIを再計算
- アラートをチェック

#### 🔄 KPI再計算
- 既存データでKPIを再計算
- ダッシュボードを更新

#### 📥 インポート
- **マカドCSV取り込み**: CSVファイルの手動取り込み
- **過去データ取り込み**: 過去分のデータ一括取り込み
- **SKUマッピング更新**: 商品マスター情報の更新

#### 📈 レポート
- **日次レポート**: 当日の売上・利益サマリー
- **週次レポート**: 週間トレンド分析
- **月次レポート**: 月間目標達成状況

## 📋 シート構成

| シート名 | 用途 | 更新頻度 |
|----------|------|----------|
| **KPI月次管理** | KPIダッシュボード | 日次 |
| **販売履歴** | 全注文明細データ | リアルタイム |
| **仕入履歴** | 仕入データ | 都度 |
| **在庫一覧** | 現在庫状況 | 日次 |
| **ASIN/SKUマスタ** | 商品マスター | 都度 |
| **データ連携ログ** | 処理履歴 | 自動 |
| **設定** | システム設定 | 都度 |

## ⚠️ 重要な注意事項

### セキュリティ
- **API認証情報は厳重に管理**してください
- スプレッドシートの共有設定に注意
- 他人との認証情報共有は絶対に避ける

### データ管理
- 月次でのデータアーカイブを推奨
- 重要なデータは定期的にバックアップ
- SKU統一ルールの徹底

### 運用上の制限
- Google Apps Scriptの実行時間制限（6分）
- API Rate Limitの考慮
- スプレッドシート行数制限（1000万行）

## 🐛 トラブルシューティング

### よくある問題

#### データが取得できない
1. 「設定」シートのAPI認証情報を確認
2. 「管理」 > 「エラーログ確認」でエラー詳細を確認
3. Amazon SP-APIの利用制限を確認

#### KPIが正しく計算されない
1. 「KPI再計算」を実行
2. 元データ（販売履歴・在庫）の整合性を確認
3. SKUマッピングの重複・欠損をチェック

#### CSVの取り込みエラー
1. ファイルの文字エンコーディング（Shift-JIS）を確認
2. CSVのフォーマットが想定通りかチェック
3. ファイルサイズ（10MB以下）を確認

### エラーログの確認

1. 「管理」 > 「エラーログ確認」
2. 「_エラーログ」シートで詳細確認
3. エラーの種別と発生パターンを分析

### サポート

- **GitHub Issues**: [Issues](https://github.com/taktok21/KPI-management-GoogleSpredSheet/issues)
- **ドキュメント**: `docs/`フォルダの設計書を参照
- **テスト実行**: 「管理」 > 「テスト実行」で動作確認

## 🔄 アップデート手順

1. 最新のコードをGitHubから取得
2. 変更された`.gs`ファイルをApps Scriptエディタで更新
3. 「KPI再計算」を実行して動作確認
4. 必要に応じて設定を調整

## 📈 発展計画

### Phase 1（現在）
- ✅ Google Spreadsheet版
- ✅ 基本的なKPI管理
- ✅ マカドCSV連携

### Phase 2（3ヶ月後）
- 🔄 Amazon SP-API完全対応
- 📱 モバイル対応
- 📊 高度な分析機能

### Phase 3（6ヶ月後）
- 🌐 Webアプリケーション化
- 🤖 AI予測機能
- 📈 複数マーケットプレイス対応

## 🤝 コントリビューション

1. このリポジトリをフォーク
2. フィーチャーブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチをプッシュ (`git push origin feature/amazing-feature`)
5. Pull Requestを作成

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は[LICENSE](LICENSE)ファイルを参照してください。

## 🏷️ バージョン履歴

### v1.0.0（2025-01-XX）
- 初回リリース
- 基本的なKPI管理機能
- マカドCSV連携
- Google Spreadsheet UI

---

**月利80万円達成に向けて、データドリブンな物販経営を始めましょう！** 📈

## 🔗 関連リンク

- [Amazon SP-API Documentation](https://developer-docs.amazon.com/sp-api/)
- [Google Apps Script Documentation](https://developers.google.com/apps-script)
- [Google Sheets API](https://developers.google.com/sheets/api)